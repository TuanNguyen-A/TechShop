<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <meta name="description" content="" />
  <meta name="author" content="Mannat Themes" />
  <meta name="keyword" content="" />
  <title>Admin</title>
  <script src="../../public/common/js/utility.js"></script>
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
  <script src="../../public/admin/js/config.js"></script>
  <link rel="stylesheet" href="../../public/admin/css/show-category.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
    crossorigin="anonymous"></script>
  <link href="../../public/admin/css/bootstrap.min.css" rel="stylesheet" />
  <link href="../../public/admin/css/slidebars.min.css" rel="stylesheet" />
  <link href="../../public/admin/css/menu.css" rel="stylesheet" type="text/css" />
  <link href="../../public/admin/css/style.css" rel="stylesheet" />
  <link rel="stylesheet" href="../../public/admin/css/show.css" />

  <!-- include summernote css/js -->
  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>
</head>

<body class="sticky-header">
  <section>
    <!-- sidebar left start-->
    <div class="sidebar-left">
      <div class="sidebar-left-info">
        <div class="user-box">
          <div class="d-flex justify-content-center">
            <img
              src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT6H65JU6l94aZA9XB0KipsS650UDzF-YRVBnvEQeHWb4oXTw_qLSUSzFoVvi_i49OJ53o&usqp=CAU"
              alt="" class="img-fluid rounded-circle" />
          </div>
          <div class="text-center text-white mt-2">
            <h6>Admin</h6>
          </div>
        </div>

        <!--sidebar nav start-->
        <ul class="side-navigation">
          <li class="menu-list">
            <a target="_top" href="../users/show.html">
              <span>User account</span></a>
          </li>

          <li class="menu-list">
            <a target="_top" href="../feedback/show.html">
              <span>Feedback</span></a>
          </li>
          <li class="menu-list">
            <a target="_top" href="../orders/show.html">
              <span>Order List</span></a>
          </li>
          <li class="menu-list">
            <a target="_top" href="../category/show.html">
              <span>Category List</span></a>
          </li>
          <li class="menu-list">
            <a target="_top" href="../product/show.html">
              <span>Product List</span></a>
          </li>
        </ul>
        <!--sidebar nav end-->
      </div>
    </div>
    <!-- sidebar left end-->

    <!-- body content start-->
    <div class="body-content">
      <!-- header section start-->
      <div class="header-section">
        <!--logo and logo icon start-->
        <div class="logo">
          <a href="index.html">
            <span class="logo-img">
              <img src="assets/images/logo_sm.png" alt="" height="26" />
            </span>
            <!--<i class="fa fa-maxcdn"></i>-->
            <span class="brand-name">LETech</span>
          </a>
        </div>

        <!--mega menu start-->
        <div id="navbar-collapse-1" class="navbar-collapse collapse mega-menu">
          <ul class="nav navbar-nav">
            <!-- Classic list -->
            <li>
              <form class="search-content" action="index.html" method="post">
                <input type="text" class="form-control mt-3" name="keyword" placeholder="Search..." />
                <span class="search-button"><i class="ti ti-search"></i></span>
              </form>
            </li>
          </ul>
        </div>
        <!--mega menu end-->

        <div class="notification-wrap">
          <!--right notification start-->
          <div class="right-notification">
            <ul class="notification-menu"></ul>
          </div>
          <!--right notification end-->
        </div>
      </div>
      <!-- header section end-->

      <div class="container-fluid">
        <div class="page-head">
          <h4 class="mt-2 mb-2">Product</h4>
        </div>

        <div class="row">
          <div class="col-lg-12 col-sm-12">
            <div class="card m-b-30">
              <div class="card-body">
                <div class="row">
                  <div class="col-sm-12">
                    <div class="table-responsive">
                      <div class="panel panel-primary">

                        <div class="panel-body">
                          <form action="">

                            <div class="form-group">
                              <label for="title">Title</label>
                              <input type="text" class="form-control" id="title" name="title" placeholder="Enter title">
                            </div>
                            <div class="form-group">
                              <label for="category_id">Category</label>
                              <div id="category_id">

                              </div>
                            </div>
                            <div class="form-group">
                              <label for="price">Price</label>
                              <input type="number" class="form-control" id="price" name="price"
                                placeholder="Enter price">
                            </div>
                            <div class="form-group">
                              <label for="discount">Discount</label>
                              <input type="number" class="form-control" id="discount" name="discount"
                                placeholder="Enter discount (%)">
                            </div>
                            <div class="form-group">
                              <label for="quantity">Quantity</label>
                              <input type="number" class="form-control" id="quantity" name="quantity"
                                placeholder="Enter quantity">
                            </div>
                            <div class="form-group">
                              <label for="thumbnail">Thumbnail</label>
                              <input type="text" class="form-control" id="thumbnail" name="thumbnail"
                                placeholder="Enter thumbnail">
                              <div id="thumbnail_img"></div>
                            </div>
                            <div class="form-group">
                              <label for="description">Description</label>
                              <textarea name="description" class="form-control" id="description" rows="5"></textarea>
                            </div>


                            <div class="">Thông Số Kĩ Thuật</div>

                            <div class="form-group">
                              <label for="screen_size">Kích thước màn hình</label>
                              <input type="text" class="form-control" id="screen_size" name="screen_size"
                                placeholder="Enter " />
                            </div>

                            <div class="form-group">
                              <label for="screen_technology">Công nghệ màn hình</label>
                              <input type="text" class="form-control" id="screen_technology" name="screen_technology"
                                placeholder="Enter " />
                            </div>

                            <div class="form-group">
                              <label for="rear_camera">Camera sau</label>
                              <textarea name="rear_camera" class="form-control" id="rear_camera" rows="5"></textarea>
                            </div>

                            <div class="form-group">
                              <label for="front_camera">Camera trước</label>
                              <textarea name="front_camera" class="form-control" id="front_camera" rows="5"></textarea>
                            </div>

                            <div class="form-group">
                              <label for="chipset">Chipset</label>
                              <input type="text" class="form-control" id="chipset" name="chipset"
                                placeholder="Enter " />
                            </div>

                            <div class="form-group">
                              <label for="ram">RAM</label>
                              <input type="text" class="form-control" id="ram" name="ram" placeholder="Enter " />
                            </div>

                            <div class="form-group">
                              <label for="main_memory">Bộ nhớ trong</label>
                              <input type="text" class="form-control" id="main_memory" name="main_memory"
                                placeholder="Enter " />
                            </div>

                            <div class="form-group">
                              <label for="battery">Pin</label>
                              <input type="text" class="form-control" id="battery" name="battery"
                                placeholder="Enter " />
                            </div>

                            <div class="form-group">
                              <label for="sim">SIM</label>
                              <input type="text" class="form-control" id="sim" name="sim" placeholder="Enter " />
                            </div>

                            <div class="form-group">
                              <label for="operating_system">Hệ điều hành</label>
                              <input type="text" class="form-control" id="operating_system" name="operating_system"
                                placeholder="Enter " />
                            </div>

                            <div class="btn-center">
                              <button id="btn-submit" class="btn btn-primary">Add</button>
                            </div>

                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
  </section>

  <script type="text/javascript">
    $(function () {

      $('#description').summernote({
        height: 350,
        codemirror: {
          theme: 'monokai'
        }
      });

      var id = '';
      var category_id = [];
      id = getUrlParameter('id');

      //Edit data
      if (id) {
        $.post(BASE_URL + API_PRODUCT, {
          'action': QUERY,
          'id': id
        }, function (data) {
          var obj = JSON.parse(data);
          if (obj.status == 1) {
            var product = obj.product;
            $("[name=title]").val(product.title);
            $("[name=price]").val(product.price);
            $("[name=discount]").val(product.discount);
            $("[name=quantity]").val(product.quantity);
            $("[name=thumbnail]").val(product.thumbnail);
            $("[name=description]").val(product.description);
            $("[name=screen_size]").val(product.screen_size);
            $("[name=screen_technology]").val(product.screen_technology);
            $("[name=rear_camera]").val(product.rear_camera);
            $("[name=front_camera]").val(product.front_camera);
            $("[name=chipset]").val(product.chipset);
            $("[name=ram]").val(product.ram);
            $("[name=main_memory]").val(product.main_memory);
            $("[name=battery]").val(product.battery);
            $("[name=sim]").val(product.sim);
            $("[name=operating_system]").val(product.operating_system);
            category_id = obj.categoryList;
            console.log(obj.categoryList);
            $("form").submit(function (e) {
              //product info
              var title = $("[name=title]").val();
              var price = $("[name=price]").val();
              var discount = $("[name=discount]").val();
              var quantity = $("[name=quantity]").val();
              var thumbnail = $("[name=thumbnail]").val();
              var description = $("[name=description]").val();
              var checkbox = $("[name=category_id]");
              var category_id = [];
              for (var i = 0; i < checkbox.length; i++) {
                if (checkbox[i].checked === true) {
                  category_id.push(checkbox[i].value);
                }
              }

              //Specification
              var screen_size = $("[name=screen_size]").val();
              var screen_technology = $("[name=screen_technology]").val();
              var rear_camera = $("[name=rear_camera]").val();
              var front_camera = $("[name=front_camera]").val();
              var chipset = $("[name=chipset]").val();
              var ram = $("[name=ram]").val();
              var main_memory = $("[name=main_memory]").val();
              var battery = $("[name=battery]").val();
              var sim = $("[name=sim]").val();
              var operating_system = $("[name=operating_system]").val();

              $.post(BASE_URL + API_PRODUCT, {
                'action': UPDATE,
                'id': id,
                'title': title,
                'category_id': category_id,
                'price': price,
                'discount': discount,
                'quantity': quantity,
                'thumbnail': thumbnail,
                'description': description,
                'screen_size': screen_size,
                'screen_technology': screen_technology,
                'rear_camera': rear_camera,
                'front_camera': front_camera,
                'chipset': chipset,
                'ram': ram,
                'main_memory': main_memory,
                'battery': battery,
                'sim': sim,
                'operating_system': operating_system
              }, function (data) {
                var obj = JSON.parse(data);
                if (obj.status == 1) {
                  window.open('show.html', '_self');
                } else {
                  alert(obj.msg);
                }
              });

              return false;
            })
          } else {
            id = '';
          }
        })
      }


      //add new product
      if (id == '') {
        $('#btn-submit').on('click', function (e) {
          //product info
          var title = $("[name=title]").val();
          var price = $("[name=price]").val();
          var quantity = $("[name=quantity]").val();
          var discount = $("[name=discount]").val();
          var thumbnail = $("[name=thumbnail]").val();
          var description = $("[name=description]").val();
          var checkbox = $("[name=category_id]");
          var category_id = [];

          for (var i = 0; i < checkbox.length; i++) {
            if (checkbox[i].checked === true) {
              category_id.push(checkbox[i].value);
            }
          }

          //Specification
          var screen_size = $("[name=screen_size]").val();
          var screen_technology = $("[name=screen_technology]").val();
          var rear_camera = $("[name=rear_camera]").val();
          var front_camera = $("[name=front_camera]").val();
          var chipset = $("[name=chipset]").val();
          var ram = $("[name=ram]").val();
          var main_memory = $("[name=main_memory]").val();
          var battery = $("[name=battery]").val();
          var sim = $("[name=sim]").val();
          var operating_system = $("[name=operating_system]").val();

          $.post(BASE_URL + API_PRODUCT, {
            'action': ADD,
            'title': title,
            'price': price,
            'quantity': quantity,
            'discount': discount,
            'thumbnail': thumbnail,
            'description': description,
            'category_id': category_id,

            'screen_size': screen_size,
            'screen_technology': screen_technology,
            'rear_camera': rear_camera,
            'front_camera': front_camera,
            'chipset': chipset,
            'ram': ram,
            'main_memory': main_memory,
            'battery': battery,
            'sim': sim,
            'operating_system': operating_system
          }, function (data) {
            alert(data);
            var obj = JSON.parse(data);
            if (obj.status == 1) {
              window.open('show.html', '_self');
            } else {
              alert(obj.msg);
            }
          });
        })
      }

      //Category List
      $.post(BASE_URL + API_CATEGORY, {
        'action': LIST,
        'search': ''
      }, function (data) {
        var obj = JSON.parse(data);
        if (obj.status == 1) {
          categoryList = obj.categoryList;
          for (i = 0; i < categoryList.length; i++) {
            item = categoryList[i];
            $('#category_id').append(`
                            <input type="checkbox" name="category_id" value="${item['id']}" ${category_id.includes(item['id']) ? 'checked' : ''}>${item['name']}
                            `);
          }
        } else {
          window.open('../authen/login.html', '_self');
        }
      });


      //Display thumbnail
      $('#thumbnail').on('change', function () {
        $('#thumbnail_img').html('');
        $('#thumbnail_img').append(`<img src="${$('#thumbnail').val()}" alt="thumbnail">`)
      })

      console.log()
    })


  </script>
</body>

</html>